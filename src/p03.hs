main = do
  print sol1 -- 198
  print sol2 -- 5140884672

sol1 = hitcount (3,1)
sol2 = product $ fmap hitcount [(1,1),(3,1),(5,1),(7,1),(1,2)]

hitcount (right, down) = sum [1 | (x,row) <- rows, row !! (x `mod` width) == '#']
    where rows = zip [0, right..] $ every_nth down input

every_nth _ [] = []
every_nth n (x:xs) = x : every_nth n (drop (n-1) xs)

width = length (head input)

input =
  [ "..#..#......#..#.......#...#.#."
  , "...##.....##..#..#....#.##.##.#"
  , "...#...#.##...##.....#.....#.#."
  , "..#....#.....#...##.##.###.#..."
  , ".#.....#......#..#.##.#...###.."
  , "#..#..#.#......#...........###."
  , "#......####.#....##........##.."
  , ".#.......#.....#......#...#...."
  , "...#...#.....#.......##.....##."
  , "#...##.........#.#..##..#..#.##"
  , "#.#.##.........#.#..#.#.....###"
  , ".##..##...#....##.....#..#....."
  , "........#.......###.#.#.....#.#"
  , "...#.#....#.##..#...##..##..#.."
  , "......#....#........######.#..."
  , ".##...#.#...###......#.#.#..#.#"
  , "........#.##...##.#...#..#...##"
  , ".#..#.#..##....###..#.#.......#"
  , "..#..##..#.#...#.##......#....."
  , "##.....#..##.#.#..#......##...#"
  , "......................#..#..#.."
  , "..#.##....####.........###.##.."
  , "##..###..#...#....#..#.#...#..."
  , ".##.#......#..#....#........#.."
  , ".#.....#..#..#.#.#....#.....##."
  , "..........#..#....#..##...#..##"
  , ".#...#.#....#.##..#.....#....#."
  , "#..............#.#.#..#..#....#"
  , "...#.#...............##........"
  , "#.#.##...#.##..##.....#........"
  , "...#.......###..###..#...#..#.."
  , "####..#.#..##.....##.#.#......#"
  , ".#.#.......#..##.......#......."
  , "#....#...#.##.#.......#..#....."
  , ".#...##..#..#..##.......##...#."
  , ".#..#......#.........#........."
  , "#.##.#.....#....#..##..#.....#."
  , "#.#....#.#....#...#.#..#....#.."
  , "#..#.....#.##..#.....#...##...#"
  , "#....#...##.#.........#.#....##"
  , ".......##.##......##.......##.."
  , "#.....#..#........#........#..."
  , "#....#.#..#.#........##.#...#.."
  , "#.......#.#.#.#....#.......##.#"
  , "...#..###..........#...#.#.###."
  , "....#..#....#...#....##.#.....#"
  , ".#..##.....#..#....##..##...#.#"
  , "#.........#....#.#..###...##..."
  , ".#.#.........#.#.......#.#.#..#"
  , "..........#........##..#......."
  , ".....#.......#...#.....#..##.##"
  , "...#.........#.............####"
  , "##..#...#..#.#......#...#......"
  , ".#..###...#.#.#.#...#...#......"
  , "....#..##.#....#..#.#..##..##.#"
  , "..#.......#......#..#.......#.."
  , "....###......#...##...#....#..."
  , "..#..#.....#...#..###....#.#..#"
  , ".........##..#.##....#..##..#.."
  , "##...#...#.#.........##......#."
  , "###..#.#....#......##..##.#...#"
  , ".##...##..#.#.#.#......#..#...."
  , "###......#..#..#.....#..#....#."
  , ".#.#..##....##........##..#.#.."
  , "###...####.#....#.......###...."
  , "..#....###..#.#.#..#.......##.."
  , ".......#.#...#.....#.#....##.#."
  , "......#......#.#....#..##..###."
  , "....####..........#.....#......"
  , ".###.....#...#..#...##.#...###."
  , "...##....##....###....#.#..#.#."
  , "##.#..........##.........#.##.."
  , "..#..#.#.###..##..#....##.....#"
  , "..#....##.....#...##....###..##"
  , "....#.......##..#..#..........#"
  , "............#..#.###..#.#......"
  , "...........##......#.#.#...#..#"
  , "...##.##....#...##.##.....#.#.."
  , ".####...#....###...#.....#....#"
  , ".##........#..##..#.#.....#...."
  , "..................#.....#..##.."
  , "..###.....#.##..#..#....##...#."
  , "...#.##.#.####.#.###.#....#..##"
  , ".#....##..##......####.#####..."
  , "#...#.#....##.........##....#.."
  , "..#.##.....##.............#.##."
  , "###.....#.#..#..#......#.##.#.."
  , "...#..##.....#...##...#......#."
  , ".##.#...#......##.#..##....#..."
  , ".....##.....#......#.#........."
  , "#.....#.....#........##........"
  , ".#......##...#..#.#....###.#..#"
  , "#.####...#....#.........#..#..."
  , "#..##.#.....#.##.##.#....#...#."
  , "#########..#....#..#...#......#"
  , "..##..##...###.######...##.##.."
  , "##.......#.......#.#....###..#."
  , ".....#...#.######..#.....#....."
  , ".#......#..#.............#.##.#"
  , "..###.#.#......##...###........"
  , ".......####.#..##....#........#"
  , "..#......#.##....##.##....#...."
  , "....#......#.#....#..#.#.....##"
  , "####.....#....#.#......#.#.#.##"
  , "#...##....#.#.##.........#....#"
  , "....#..###......#......#...#..."
  , ".....##.#..#..#...#..#.#.#....."
  , ".##............#.....#........."
  , "##...#..#.....##.#..#.........."
  , "#.....#####.......#..#....#.#.."
  , ".........#..#.....###........#."
  , "#....#..#...###........#..#.#.."
  , "...##...#..#...#.##..#........."
  , ".........#.#.....#.......#...#."
  , ".#.....#..####....#.##.......##"
  , "...............##....##.##..##."
  , "............#....#....#...##.#."
  , "..#...#........#.......#..#...."
  , "##....####....#.##...#..##..#.#"
  , ".#.#.....#......#.#........#.#."
  , "....#......#.#....##..##......."
  , ".#..#.#..#..##.....#..........."
  , "..#........#.##..#......##..#.."
  , "...##.#...#...#..#........#...."
  , "##..##....#......#...#..#.#.#.#"
  , "......#.....#..#..#....#......."
  , ".....##......#..#.#.##...#....."
  , "...#.....#.#..........#..##...#"
  , ".####.##....#...........#.....#"
  , ".....###..##...#....##..#...#.."
  , "..##...#.#...#..........#..#.#."
  , "...#..#..............#.##.#...."
  , "##.#....#...#..#....#.........."
  , ".##..........#..#........#....."
  , "#...#.#......#...#.....##..#..."
  , ".##...#.#.#....###.####..#....#"
  , ".#......#.#...#.#....#.#...#..."
  , "#....##.###.............#.#...."
  , "....#.###..##..##.##...##......"
  , "##....#..###.##.##.....#......#"
  , "..#..#..#......#..#..#........."
  , "#.##......#.#....#..#..#......."
  , "....#.#...#..###......##......."
  , ".###.......##.......#....###..."
  , "..#..#.##..#.#....#..#.#.....#."
  , ".#..##.##..............#....#.."
  , "#...#.#...#..#.##..##.#.#......"
  , "#...#..#..##..##.###......#...."
  , ".#..#.....#...#....#.....#...#."
  , ".....#....#..#.....###...#.####"
  , ".#.....#......#...##...#..#...."
  , ".#......#............#.#......."
  , "....##....#.#..#..#...#..#.#..."
  , "#...#.....###...##...#.##.....#"
  , ".......#.....#....#.......#...#"
  , "#.......###.......#.#.........."
  , "...#.#.###.#........#.###...#.."
  , "....#............#....#..#....."
  , "#......#.##.#...##.......#..#.#"
  , ".....#....#....#.#.#...###..#.."
  , ".....#.#...#...#.#..#....#.#..#"
  , ".#.......#.#..#...###.......##."
  , ".......#..#.##.........#......."
  , ".##.#........#.##...##....#...."
  , ".#....#..#...#......####...#..#"
  , "...#.....#..##.#..#.#....#....#"
  , "...##....#........#.#........#."
  , ".....#....##..#.##..........#.."
  , "#.....#.#.#......##....##.#..#."
  , ".#.#.##..#.#....##.#....##....."
  , ".....#.....#..#.#....#..#....##"
  , "...#........#....#......###.#.."
  , ".....##...#.....##.##.#.#.##..."
  , "...#.....#####....##.#.#.###.#."
  , ".#..#.#..##...###.........#.#.#"
  , "#...#...#.#..#...#...........#."
  , ".##..............#...#..#....#."
  , "....###.........#.#.#....#....."
  , "..#...##.#.#....##.#..#...#..#."
  , "..#.....#.#......#....#......#."
  , ".......##....#.#.##....#...#..#"
  , "##.#.#...#..#......#..#..#....#"
  , "...#.#......#............###.##"
  , "..###..#..##..#...##........#.."
  , ".#...#...##...#....#....##.#..#"
  , "..##...####....#....#..#....#.#"
  , "...#......##....#.........##.#."
  , "##.#.......#..#..#............."
  , "..#.#.#.#......#...#.#..##....."
  , ".#..##.....###...##.#..#......#"
  , "##...#..........#.####....##..."
  , "#..........#...#..##....#......"
  , "....##...#....#..####...#.##.##"
  , ".#.######...##...#..##........."
  , "....##.........#.......##.##..."
  , ".#.....#.#..........##......#.."
  , "...#..#.#.###..#........#.....#"
  , "..##..#............##.......#.."
  , "......##....##..#.##..#.......#"
  , ".......##....#.......#..#...#.#"
  , "#.#......#.###.....#.##........"
  , ".#..##..........#..#.....#.##.."
  , "..#.#...#....#.........#..##..#"
  , ".#......#.......#...#..#..###.."
  , "......#.##.....#.#......#....#."
  , "....#....#...#.......#...##.##."
  , "#....#...##...#..##........###."
  , "##......#.#..#.......#.......#."
  , "...##.##..#......#.###..#.#.##."
  , ".............#..#.............#"
  , "..#.......##..#..#....##...#..."
  , "...............##..##........#."
  , "##...#.##.......#....#.......##"
  , "....##.##.#.#.....##.....##.##."
  , "#.#......#.......#..#.#..#....."
  , "....##....#.##........##.##.#.."
  , "......##....#..##..#..##....##."
  , ".............#.....#.......#..."
  , ".......###.......#..........#.."
  , "......##.#..#.....#.#...#.#...#"
  , ".#...#..#..###.###...#....##..."
  , "#......#..#.#...#...#.....#..##"
  , ".###.....#..#.#......##..#.##.."
  , ".##.#.....#..#.#..#....##......"
  , "#......#..............#.....#.#"
  , "...#..#....#.....#.....##.#...#"
  , "......#..##..##.....#...#......"
  , ".....####..#..#.##.......#..#.#"
  , "###.#.#........#.......#.....##"
  , "..#.#.#.#...#...#........#....#"
  , "....##.#.#..#...##.....#......#"
  , "#..#.##....#..#.##..####......."
  , "...####.#...#......#......##..#"
  , "#....#.#..###......#..#..##..#."
  , "...........#....#...#......#..."
  , "......###.#.....#.#....#.#...#."
  , ".......#.##..............#..##."
  , "..##...........#..#.#...#.....#"
  , "#..#............##.........#.#."
  , ".......###.#...#.#...#.#.#...#."
  , "..#...##.......#..#......#.#.##"
  , "#.#...#.....#...##.#.#.......##"
  , ".#.#.##...#..##.#......#......."
  , "#.......#.......#.#....#.....#."
  , ".....#..#..#.......#..#........"
  , "##...##...##......#..##.###...."
  , "..#...#.###.#.###..#.....###..."
  , ".....####.......#.#.....##....#"
  , "....#....#.#....#...#..#.#..#.."
  , "..##.....#....#.#.#.###...#...."
  , "......#.#....#.#..#....#.#..#.."
  , "#...#...#....#.......#......#.#"
  , "#..#.#......#..#...........#.##"
  , "...............#....#.....#...#"
  , ".#.#.#...#.##...#.#.#..#....#.."
  , "...#.#.####..##.#...##........."
  , "##.........##.##.....##....#..."
  , "................#...#.##.#.#..#"
  , ".#..#....#...#..#..#..###.#..#."
  , "...#..#.##.#.####..........#..#"
  , "........#....##......#..#.#...."
  , "........##.........#..#..#..#.#"
  , "#......#.#...#...#...##.....#.."
  , "#...#.....#..#..##.#...#.#.#..."
  , "....#..##...##.....#...#.#....."
  , "..#..##....#....#...#....#....."
  , ".#..#...##.......###...#...#..."
  , ".#......#......#..##..#..##...."
  , "....##....#..#.#....#.#..##...."
  , "###......#...........#.....###."
  , ".....#...#..##.#..#..#.....#..#"
  , "#.#....#...........#.##..#..###"
  , "#....#...###.#...#..##..#.....#"
  , ".#....#......##.#..#....#.#...."
  , "....#.#....#..#.#....#..#..#..."
  , "..#......#..#.#.#....#........."
  , ".#...#.#.....#........#.#...###"
  , "....#..##.......#.###....##...."
  , "#.#.......#......#.###........#"
  , "#.........#.....####.##..#..#.."
  , ".#.#..##...#.#.....##.#.#..#..."
  , ".#..#..#..#.##..#...###.#...#.."
  , ".....##..##..##..#.#.#.....###."
  , ".#..#...#..#......##.#........."
  , "....#..##....#.##.........#...#"
  , "........#...#...###.........##."
  , "#.........#..##....#.#...#....."
  , ".......#.......#..#.......#...."
  , "#......##......#.#.##.........."
  , ".#..##..####...#.....####.....#"
  , "........#.#....#..##..###.#...#"
  , ".#...#...#.........###..#...#.#"
  , "#.........#....##...#.........."
  , ".#.#....#..........#..........."
  , ".#.#..........#.##.....#.##...."
  , "..#....#...##..###..........##."
  , ".#.#..#.##..#..#.##.##..##....."
  , "........#...#....#...#.#..##..."
  , "......#......##..#..#.....#..#."
  , ".##.#....#...#....#...#..##..##"
  , "##............#..........###..."
  , "....#.......#.#..#.#####.....#."
  , "#......#.....#...#........#...."
  , "..##.....###..#.#.#.#....#....#"
  , "#...#...#.#..#..#....#..#......"
  , "......#....#...#..#....#####..."
  , "....#.......##....#....##......"
  , ".....##...#.##.#.....##....#..."
  , ".#....###.#..##...##.##.......#"
  , "....#.#.#.##.............#..##."
  , "...........##......#...#.#.##.."
  , "....##......#....#....##..##.#."
  , ".#.#...#.....##.....#.........#"
  , "#.#..........#.......#.##...#.."
  , "....#.##..#.#....#.....#...#..."
  , "##.............##.......#.##.#."
  , "....#...#.....##...#..........#"
  , "##..#...#...#.#.##...#.......##"
  , "..#........#.....###...##..##.#"
  , ".....#...##.#.#.##.....#...#..."
  , "####.###...##..##...#..#..#..##"
  , "......#..#..#.........#...#.#.."
  , "....###.....##.##....#.##.....#"
  ]
